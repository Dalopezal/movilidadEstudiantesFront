<aside [class.collapsed]="isCollapsed" class="sidebar fuente">
  <div class="sidebar-header">
    <img src="../../../assets/logo_ucm.png" alt="Logo UCM" class="sidebar-logo" />
  </div>
  <div class="sidebar-header">
    <img src="../../../assets/logo-mobility.png" alt="Logo Mobility" class="sidebar-logo2" />
  </div>

  <nav class="sidebar-nav">
    <!-- Inicio -->
    <a
      routerLink="/home"
      routerLinkActive="active"
      [routerLinkActiveOptions]="{ exact: true }"
      class="nav-link"
    >
      <i class="fas fa-tachometer-alt"></i>
      <span class="link-text">
        {{ 'SIDEBAR.INICIO' | translate }}
      </span>
    </a>

    <!-- Internacionalización del Currículo -->
    <div class="has-submenu">
      <a
        (click)="toggleInternacionalizacionMenu()"
        class="nav-link submenu-toggle"
        role="button"
        aria-haspopup="true"
        [attr.aria-expanded]="isInternacionalizacionOpen"
      >
        <i class="fas fa-globe-americas"></i>
        <span class="link-text">
          {{ 'SIDEBAR.INTERNACIONALIZACION.TITULO' | translate }}
        </span>
        <i class="fas fa-chevron-down submenu-icon" [class.rotate]="isInternacionalizacionOpen"></i>
      </a>

      <div class="submenu" [class.open]="isInternacionalizacionOpen">
        <a routerLink="/planeacion" routerLinkActive="active" class="nav-link submenu-link">
          <i class="fas fa-dot-circle"></i>
          <span class="link-text">
            {{ 'SIDEBAR.INTERNACIONALIZACION.PLANEACION' | translate }}
          </span>
        </a>
        <a routerLink="/estrategia" routerLinkActive="active" class="nav-link submenu-link">
          <i class="fas fa-dot-circle"></i>
          <span class="link-text">
            {{ 'SIDEBAR.INTERNACIONALIZACION.ESTRATEGIA' | translate }}
          </span>
        </a>
        <a routerLink="/actividades-seguimiento" routerLinkActive="active" class="nav-link submenu-link">
          <i class="fas fa-dot-circle"></i>
          <span class="link-text">
            {{ 'SIDEBAR.INTERNACIONALIZACION.ACTIVIDADES' | translate }}
          </span>
        </a>
        <a routerLink="/aprobacion-estudiante" routerLinkActive="active" class="nav-link submenu-link">
          <i class="fas fa-dot-circle"></i>
          <span class="link-text">
            {{ 'SIDEBAR.INTERNACIONALIZACION.APROBACION_ESTUDIANTE' | translate }}
          </span>
        </a>
        <a routerLink="/certificado-estudiantes" routerLinkActive="active" class="nav-link submenu-link">
          <i class="fas fa-dot-circle"></i>
          <span class="link-text">
            {{ 'SIDEBAR.INTERNACIONALIZACION.CERTIFICADO_ESTUDIANTES' | translate }}
          </span>
        </a>
        <a routerLink="/asignacion-plan-componente" routerLinkActive="active" class="nav-link submenu-link">
          <i class="fas fa-dot-circle"></i>
          <span class="link-text">
            {{ 'SIDEBAR.INTERNACIONALIZACION.ASIGNACION_PLAN_COMPONENTE' | translate }}
          </span>
        </a>
        <a routerLink="/desarrollo-profesional" routerLinkActive="active" class="nav-link submenu-link">
          <i class="fas fa-dot-circle"></i>
          <span class="link-text">
            {{ 'SIDEBAR.INTERNACIONALIZACION.DESARROLLO_PROFESIONAL' | translate }}
          </span>
        </a>
        <a routerLink="/trayectoria" routerLinkActive="active" class="nav-link submenu-link">
          <i class="fas fa-dot-circle"></i>
          <span class="link-text">
            {{ 'SIDEBAR.INTERNACIONALIZACION.TRAYECTORIA' | translate }}
          </span>
        </a>
        <a routerLink="/horarios-universidad" routerLinkActive="active" class="nav-link submenu-link">
          <i class="fas fa-dot-circle"></i>
          <span class="link-text">
            {{ 'SIDEBAR.INTERNACIONALIZACION.HORARIOS_UNIVERSIDAD' | translate }}
          </span>
        </a>
        <a routerLink="/insignia-digital" routerLinkActive="active" class="nav-link submenu-link">
          <i class="fas fa-dot-circle"></i>
          <span class="link-text">
            {{ 'SIDEBAR.INTERNACIONALIZACION.INSIGNIA_DIGITAL' | translate }}
          </span>
        </a>
        <a routerLink="/vs" routerLinkActive="active" class="nav-link submenu-link">
          <i class="fas fa-dot-circle"></i>
          <span class="link-text">
            {{ 'SIDEBAR.INTERNACIONALIZACION.PLANEADO_VS_EJECUTADO' | translate }}
          </span>
        </a>
      </div>
    </div>

    <!-- Cooperación -->
    <div class="has-submenu">
      <a
        (click)="toggleCooperacionMenu()"
        class="nav-link submenu-toggle"
        role="button"
        aria-haspopup="true"
        [attr.aria-expanded]="isCooperacionOpen"
      >
        <i class="fas fa-handshake"></i>
        <span class="link-text">
          {{ 'SIDEBAR.COOPERACION.TITULO' | translate }}
        </span>
        <i class="fas fa-chevron-down submenu-icon" [class.rotate]="isCooperacionOpen"></i>
      </a>

      <div class="submenu" [class.open]="isCooperacionOpen">
        <a routerLink="/solicitud-convenio" routerLinkActive="active" class="nav-link submenu-link">
          <i class="fas fa-dot-circle"></i>
          <span class="link-text">
            {{ 'SIDEBAR.COOPERACION.SOLICITUDES_CONVENIO' | translate }}
          </span>
        </a>
        <a routerLink="/listsol-convenio" routerLinkActive="active" class="nav-link submenu-link">
          <i class="fas fa-dot-circle"></i>
          <span class="link-text">
            {{ 'SIDEBAR.COOPERACION.ADMIN_SOLICITUDES_CONVENIO' | translate }}
          </span>
        </a>
        <a routerLink="/convenios" routerLinkActive="active" class="nav-link submenu-link">
          <i class="fas fa-dot-circle"></i>
          <span class="link-text">
            {{ 'SIDEBAR.COOPERACION.CONVENIOS' | translate }}
          </span>
        </a>
        <a routerLink="/institucion-convenio" routerLinkActive="active" class="nav-link submenu-link">
          <i class="fas fa-dot-circle"></i>
          <span class="link-text">
            {{ 'SIDEBAR.COOPERACION.INSTITUCION_CONVENIOS' | translate }}
          </span>
        </a>
      </div>
    </div>

    <!-- Movilidad -->
    <div class="has-submenu">
      <a
        (click)="togglemovilidadMenu()"
        class="nav-link submenu-toggle"
        role="button"
        aria-haspopup="true"
        [attr.aria-expanded]="ismovilidadOpen"
      >
        <i class="fas fa-plane"></i>
        <span class="link-text">
          {{ 'SIDEBAR.MOVILIDAD.TITULO' | translate }}
        </span>
        <i class="fas fa-chevron-down submenu-icon" [class.rotate]="ismovilidadOpen"></i>
      </a>

      <div class="submenu" [class.open]="ismovilidadOpen">
        <!-- Opciones directas de movilidad -->
        <a routerLink="/dashboard" routerLinkActive="active" class="nav-link submenu-link">
          <i class="fas fa-dot-circle"></i>
          <span class="link-text">
            {{ 'SIDEBAR.MOVILIDAD.DASHBOARD' | translate }}
          </span>
        </a>

        <!-- SUBGRUPO Maestros -->
        <div class="submenu-group">
          <span class="submenu-title">
            {{ 'SIDEBAR.MOVILIDAD.GENERAL' | translate }}
          </span>

          <!-- menú dinámico generado según permisos (texto viene de backend, no se traduce) -->
          <a
            *ngFor="let m of maestros"
            [routerLink]="'/'+m.url"
            routerLinkActive="active"
            class="nav-link submenu-link"
          >
            <i class="fas fa-dot-circle"></i>
            <span class="link-text">{{ m.nombre }}</span>
          </a>
        </div>
      </div>
    </div>
  </nav>

  <div
    class="sidebar-user"
    (click)="onToggleUserMenu($event)"
    [class.open]="isUserMenuOpen"
  >
    <ng-container *ngIf="usuario?.foto && usuario.foto !== '' && usuario.foto !== 'null'; else userIcon">
      <img [src]="usuario?.foto" alt="Usuario" class="user-avatar" (error)="onImageError($event)" />
    </ng-container>
    <ng-template #userIcon>
      <i class="fas fa-user-circle user-icon"></i>
    </ng-template>

    <div class="user-info">
      <strong [style.fontSize.px]="(usuario?.nombre)?.length > 30 ? 10 : 13.5">
        {{ decodeUtf8(usuario?.nombre) }}
      </strong>
      <small>{{ usuario?.correo }}</small>
      <small>{{ usuario?.rol }}</small>
    </div>

    <i class="fas fa-chevron-down user-chevron" [class.rotate]="isUserMenuOpen"></i>

    <div class="user-submenu" *ngIf="isUserMenuOpen" (click)="$event.stopPropagation()">
      <app-language-selector></app-language-selector>
      <a
        routerLink="/login"
        routerLinkActive="active"
        [routerLinkActiveOptions]="{ exact: true }"
        (click)="onLogoutClick($event)"
        class="submenu-link"
      >
        <i class="fa fa-sign-out-alt"></i>
        {{ 'SIDEBAR.USER.SALIR' | translate }}
      </a>
    </div>
  </div>
</aside>

<br /><br /><br />
